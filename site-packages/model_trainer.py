from pyspark.ml.classification import LogisticRegression


def train(tweet_df):
    train_data, test_data = tweet_df.randomSplit([0.8, 0.2])
    naive_bayes = LogisticRegression(featuresCol="assembled_features",
                                     labelCol='text_blob_sentiment_index')

    nb_model = naive_bayes.fit(train_data)
    predictions = nb_model.transform(test_data)

    return nb_model, predictions
